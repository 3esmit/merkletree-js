if: branch = master

language: node_js
node_js:
  - "8"
  - "9"
  - "10"
dist: trusty
sudo: required
cache: npm

install:
  - npm install
  - npm install -g codecov

script:
  - npm run coverage

jobs:
  include:
    - stage: "Node.js 11"
      node_js: "11"
      script:
        - npm run coverage && codecov
      after_success:
        - npm run typedoc
        - cp jekyll/_config.yml docs/_config.yml
      deploy:
        - provider: pages
          skip_cleanup: true
          local_dir: docs/
          github_token: $GITHUB_TOKEN
          on:
            node: "11"
